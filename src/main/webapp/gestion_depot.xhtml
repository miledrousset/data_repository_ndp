<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
        <title>GT Numérique</title>
        <meta content="Interface de dépôt destinée aux membres du chantier scientifique de Notre-Dame" name="description"/>
        <meta content="" name="keywords"/>

        <!-- Favicons -->
        <link href="assets/img/favicon.png" rel="icon"/>
        <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon"/>

        <!-- CSS Files -->
        <link href="assets/css/bootstrap.min.css" rel="stylesheet"/>
        <link href="assets/css/icofont.min.css" rel="stylesheet"/>
        <link href="assets/css/animate.min.css" rel="stylesheet"/>
        <link href="assets/css/style.css" rel="stylesheet"/>
        <link href="assets/css/tableau.css" rel="stylesheet"/>
        <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces" />

        <!-- JS Files -->
        <script src="assets/js/validate.js"></script>
        <script src="assets/js/isotope.pkgd.min.js"></script>
        <script src="assets/js/bootstrap.bundle.min.js"></script>
        <script src="assets/js/main.js"></script>
    </h:head>

    <h:body>

        <p:growl id="messages" showDetail="true" />

        <ui:include src="header.xhtml"/>

        <main id="main">

            <section id="breadcrumbs" class="breadcrumbs">
                <div class="container">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2>Gestion du dépôt</h2>
                        <ol>
                            <li><a href="index.xhtml">Accueil</a></li>
                            <li>Gestion du dépôt</li>
                        </ol>
                    </div>

                </div>
            </section>

            <ui:include src="composant_connexion.xhtml"/>

            <h:panelGroup id="mainDepos" rendered="#{connexionBean.isUserConnected}">

                <section id="blog" class="blog">
                    <div class="container">
                        <div class="col-lg-12 entries">
                            <article class="entry entry-single">

                                <h2 class="entry-title">
                                    <a href="blog-single.html">Liste des dépôts effectués</a>
                                </h2>

                                <h:form style="margin-bottom: 10px">
                                    <p:commandButton onclick="PF('manuelUtilisation').show()" ajax="true"
                                                     style="border-color: #d9232d; background: #d9232d;
                                                     color: #fff; padding: 1px; font-size: 1em"
                                                     icon="pi pi-info-circle" />

                                    <!-- Visualiser Manuel d'utilsiation -->
                                    <p:dialog header="Tutoriel de dépôt HumanumBox" widgetVar="manuelUtilisation"
                                              modal="true" width="1000px" height="500px" closable="true" resizable="false">
                                        <p:media value="#{depotManagerBean.streamedContent}" width="100%" height="100%" player="pdf" />
                                    </p:dialog>
                                </h:form>

                                <div class="entry-content">
                                    <table id="resourceArray" class="table table-striped table-hover">
                                        <thead>
                                        <tr>
                                            <th>Nom</th>
                                            <th>Groupe</th>
                                            <th>Répertoire</th>
                                            <th>Dépôt</th>
                                            <th>Archeogrid</th>
                                            <th>Action</th>
                                        </tr>
                                        </thead>

                                        <tbody>
                                            <h:form id="listDepots">
                                                <ui:repeat value="#{depotManagerBean.depotsList}" var="depot">
                                                    <tr>
                                                        <td><h:outputText value="#{depot.nomDepot}"/></td>
                                                        <td><h:outputText value="#{depot.groupeTravail}"/></td>
                                                        <td><h:outputText value="#{depot.repertoir}"/></td>
                                                        <td><h:outputText value="#{depot.depotHumaNum}"/></td>
                                                        <td><h:outputText value="#{depot.archeodrid}"/></td>
                                                        <td>
                                                            <p:menuButton value="Dépôt">
                                                                <p:menuitem value="Modifier" oncomplete="PF('modifierDepot').show()"
                                                                            update="mainDepos" icon="pi pi-pencil">
                                                                    <f:setPropertyActionListener value="#{depot}" target="#{depotManagerBean.depotSelected}" />
                                                                </p:menuitem>

                                                                <p:separator />

                                                                <p:menuitem value="Télécharger" oncomplete="PF('depotDownload').show()"
                                                                            update="mainDepos" icon="pi pi-download">
                                                                    <f:setPropertyActionListener value="#{depot}" target="#{depotManagerBean.depotSelected}" />
                                                                </p:menuitem>

                                                                <!--<p:menuitem value=" Télécharger méthadoné" oncomplete="PF('depotMetadonne').show()"
                                                                            upload="mainDepos" icon="pi pi-bookmark">
                                                                    <f:setPropertyActionListener value="#{depot}" target="#{depotManagerBean.depotSelected}" />
                                                                </p:menuitem>-->

                                                                <p:separator />

                                                                <p:menuitem value="Supprimer" oncomplete="PF('deleteDepot').show()"
                                                                            upload="mainDepos" icon="pi pi-times-circle">
                                                                    <f:setPropertyActionListener value="#{depot}" target="#{depotManagerBean.depotSelected}" />
                                                                </p:menuitem>
                                                            </p:menuButton>
                                                        </td>
                                                    </tr>
                                                </ui:repeat>
                                            </h:form>
                                        </tbody>
                                    </table>
                                </div>
                            </article>
                        </div>
                    </div>
                </section>

                <h:form>
                    <!-- Supprimer dépôt -->
                    <p:confirmDialog message="Vous êtes sur le point de supprimer le dépôt '#{depotManagerBean.getDepotSelected().nomDepot}', continuer ?"
                                     header="Confirmation" severity="alert" widgetVar="deleteDepot" modal="true">

                        <p:commandButton value="Oui" ajax="false" onclick="PF('deleteDepot').hide()" >
                            <p:fileDownload value="#{depotManagerBean.deleteDepot(depot)}"/>
                        </p:commandButton>

                        <p:commandButton value="Non" onclick="PF('deleteDepot').hide();" type="button" />
                    </p:confirmDialog>

                    <!-- Téléchargé dépôt -->
                    <p:confirmDialog message="Vous êtes sur le point de télécharger le dépôt '#{depotManagerBean.getDepotSelected().nomDepot}', continuer ?"
                                     header="Confirmation" severity="alert" widgetVar="depotDownload" modal="true">

                        <p:commandButton value="Oui" ajax="false" onclick="PF('depotDownload').hide()" >
                            <p:fileDownload value="#{depotManagerBean.dowloadDepot()}"/>
                        </p:commandButton>

                        <p:commandButton value="Non" onclick="PF('depotDownload').hide();" type="button" />
                    </p:confirmDialog>

                    <!-- Téléchargé métadonnée -->
                    <p:confirmDialog message="Vous êtes sur le point de télécharger le métadonnée '#{depotManagerBean.getDepotSelected().nomDepot}', continuer ?"
                                     header="Confirmation" severity="alert"
                                     widgetVar="depotMetadonne" modal="true">

                        <p:commandButton value="Oui" ajax="false" onclick="PF('depotMetadonne').hide()" >
                            <p:fileDownload value="#{depotManagerBean.dowloadMetadonneFile()}"/>
                        </p:commandButton>

                        <p:commandButton value="Non" onclick="PF('depotMetadonne').hide();" type="button" />

                    </p:confirmDialog>

                    <!-- Modification dépôt -->
                    <p:dialog header="Modifier un dépôt" widgetVar="modifierDepot" modal="true" >
                        <div class="reply-form">
                            <div class="form-group row">
                                <label class="col-sm-6 col-form-label">Nom du dépôt</label>
                                <div class="col-sm-6">
                                    <h:outputText value="#{depotManagerBean.depotSelected.nomDepot}" />
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-sm-6 col-form-label">Date du dépôt</label>
                                <div class="col-sm-6">
                                    <h:outputText value="#{depotManagerBean.depotSelected.dateDepot}" />
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-sm-6 col-form-label">Groupe de travail</label>
                                <div class="col-sm-6">
                                    <h:outputText value="#{depotManagerBean.depotSelected.groupeTravail}" />
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-sm-6 col-form-label">Répertoire</label>
                                <div class="col-sm-6">
                                    <h:outputText value="#{depotManagerBean.depotSelected.repertoir}" />
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-sm-6 col-form-label">Dépôt Huma-Num</label>
                                <div class="col-sm-6">
                                    <p:selectOneMenu value="#{depotManagerBean.depotSelected.depotHumaNum}"
                                                     style="width:100%; font-size: 14px;">
                                        <f:selectItem itemLabel="A venir" itemValue="A venir"/>
                                        <f:selectItem itemLabel="Déposé" itemValue="Déposé" />
                                    </p:selectOneMenu>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-sm-6 col-form-label">Archeogrid</label>
                                <div class="col-sm-6">
                                    <p:selectOneMenu value="#{depotManagerBean.depotSelected.archeodrid}"
                                                     style="width:100%; font-size: 14px;">
                                        <f:selectItem itemLabel="A venir" itemValue="A venir"/>
                                        <f:selectItem itemLabel="Consultable" itemValue="Consultable" />
                                    </p:selectOneMenu>
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <p:commandButton value="Annuler" onclick="PF('modifierDepot').hide();" update="mainDepos"
                                             style="border-color: #d9232d; background: #ffffff;
                                             color: #d9232d; border-radius: 4px; padding: 3px; white-space: nowrap;
                                             transition: 0.3s; font-size: 12px; display: inline-block;"/>

                            <p:commandButton value="Enregistrer" update="listDepots" ajax="true"
                                             actionListener="#{depotManagerBean.modifierDepot()}"
                                             style="border-color: #d9232d; background: #d9232d;
                                             color: #fff; border-radius: 4px; padding: 3px; white-space: nowrap;
                                             transition: 0.3s; font-size: 12px; display: inline-block;"/>
                        </div>
                    </p:dialog>
                </h:form>
            </h:panelGroup>
        </main>

        <ui:include src="footer.xhtml"/>

    </h:body>
</html>


<!--
<h:form id="test">
            <p:dataTable id="basicDT" var="car" value="#{depotManagerBean.depotsList}">
                <f:facet name="header">
                    Basic
                </f:facet>
                <p:column headerText="Id">
                    <h:outputText value="#{car.nomDepot}" />
                </p:column>
                <p:column headerText="Year">
                    <h:outputText value="#{car.groupeTravail}" />
                </p:column>
                <p:column headerText="Brand">
                    <h:outputText value="#{car.groupeTravail}" />
                </p:column>
                <p:column headerText="Color">
                    <h:outputText value="#{car.archeodrid}" />
                </p:column>
                <p:column style="width:32px;text-align: center">

                    <p:menuButton value="Options">
                        <p:menuitem value="Modifier" oncomplete="PF('modifierDepot').show()" update="mainDepos" icon="pi pi-save">
                            <f:setPropertyActionListener value="#{car}" target="#{depotManagerBean.depotSelected}" />
                        </p:menuitem>
                        <p:separator />
                        <p:menuitem value="Télécharger dépôt" oncomplete="PF('depotMetadonne').show()" update="mainDepos" icon="pi pi-refresh">
                            <f:setPropertyActionListener value="#{car}" target="#{depotManagerBean.depotSelected}" />
                        </p:menuitem>
                        <p:menuitem value="Télécharger méthadoné" oncomplete="PF('depotMetadonne').show()" upload="mainDepos" icon="pi pi-times">
                            <f:setPropertyActionListener value="#{car}" target="#{depotManagerBean.depotSelected}" />
                        </p:menuitem>
                        <p:separator />
                        <p:menuitem value="Supprimer dépôt" oncomplete="PF('deleteDepot').show()" upload="mainDepos" icon="pi pi-times">
                            <f:setPropertyActionListener value="#{car}" target="#{depotManagerBean.depotSelected}" />
                        </p:menuitem>
                    </p:menuButton>

                    <p:commandButton update="mainDepos" oncomplete="PF('modifierDepot').show()" icon="pi pi-search"
                                     title="Modifier le status du dépôt">
                        <f:setPropertyActionListener value="#{car}" target="#{depotManagerBean.depotSelected}" />
                    </p:commandButton>

                    <p:commandButton update="mainDepos" oncomplete="PF('depotMetadonne').show()"
                                     icon="pi pi-search" title="Télécharger le fichier métadonnée">
                        <f:setPropertyActionListener value="#{car}" target="#{depotManagerBean.depotSelected}" />
                    </p:commandButton>

                    <p:commandButton update="mainDepos" oncomplete="PF('depotDownload').show()"
                                     icon="pi pi-search" title="Télécharger le dépôt">
                        <f:setPropertyActionListener value="#{car}" target="#{depotManagerBean.depotSelected}" />
                    </p:commandButton>

                    <p:commandButton update="mainDepos" icon="ui-icon-close" title="Supprimer le dépôt"
                                     oncomplete="PF('deleteDepot').show()" >
                        <f:setPropertyActionListener value="#{car}" target="#{depotManagerBean.depotSelected}" />
                    </p:commandButton>

                </p:column>
            </p:dataTable>
        </h:form>
-->